<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">


	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
	<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

	<link rel="icon" type="image/png" href="/assets/images/favicon.png">
	<link href="https://npm.elemecdn.com/prism-themes/themes/prism-vsc-dark-plus.css" rel="stylesheet">
	<link href="/assets/css/index.css" rel="stylesheet">
	<link href="/assets/css/header.css" rel="stylesheet">
	<link href="/assets/css/footer.css" rel="stylesheet">

	<!-- Conditionally load the CSS files -->
	

	<!-- Meta -->
	<title>Custom Tensorrt Plugin</title>
	<meta name="description" content="
		  
			A site to showcase Himanshu Mittal's writing on AI, technology, philosophy and productivity.
		  
		">
</head>

<body>
	<div class="page-container">
		<header>
    <div class="header-container">
        <!-- Logo -->
        <a href="/" class="logo">
            <picture><source type="image/avif" srcset="/img/YcBxjvMwsE-79.avif 79w"><source type="image/webp" srcset="/img/YcBxjvMwsE-79.webp 79w"><img loading="lazy" decoding="async" src="/img/YcBxjvMwsE-79.png" alt="Logo for Light Mode" class="logo-image light-mode-logo" width="79" height="48"></picture>
            <picture><source type="image/avif" srcset="/img/WWFT1o-94Z-80.avif 80w"><source type="image/webp" srcset="/img/WWFT1o-94Z-80.webp 80w"><img loading="lazy" decoding="async" src="/img/WWFT1o-94Z-80.png" alt="Logo for Dark Mode" class="logo-image dark-mode-logo" width="80" height="48"></picture>
        </a>

        <!-- Navigation Menu -->
        <nav class="site-nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a href="/about/" class="">
                        About
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="/" class="">
                        Posts
                    </a>
                </li>
                
            </ul>
        </nav>

        <!-- Color Mode Toggle -->
        <button class="color-mode-toggle" aria-label="Toggle Color Mode">
            <span class="toggle-icon">ðŸŒž</span>
        </button>
    </div>
</header>


		<main class="main-content">
			
<h1>Custom Tensorrt Plugin</h1>
<!-- date: 2024-02-04T19:55:44+05:30 tags: ["deep learning", "optimization"]-->
<p><a href="https://developer.nvidia.com/tensorrt">NVIDIA TensorRT</a> is an SDK for high-performance deep learning inference. It includes a deep learning inference optimizer and runtime that delivers low latency and high throughput for deep learning inference applications. This work &quot;Custom TensorRT Plugin&quot; was completed as a project under TensorRT bootcamp organized by NVIDIA in our college. The task was to code a custom native TensorRT plugins, use them and document results.</p>
<p>There were very few articles on TensorRT in Dec 2019, so we had to read tons of documentation (I read <a href="https://docs.nvidia.com/deeplearning/tensorrt/developer-guide/index.html">this</a> about 15 times) and the fact that it is not completely open-sourced made it even harder. Me and my teammate (team of 2) only had ~45 days to complete the task from which half of the days were wasted due to some communication errors from the management. Actually we were in misconception that we can use tensorflow integrated tensorRT (TRT) and change the computational graph using tensorflow 1.x versions. We actually ended up optimizing inference of ResNet-50 model using integrated plugins.</p>
<p>After one doubt session with NVIDIA developers, we got clarity and decided to optimize <a href="https://medium.com/@neuralnets/swish-activation-function-by-google-53e1ea86f820">Swish activation function</a>. We wrote our plugin in C++ understanding data types written in NVIDIA libraries and then using <a href="https://docs.nvidia.com/deeplearning/tensorrt/api/python_api/graphsurgeon/graphsurgeon.html">graphsurgeon</a> library, we used our plugin by mapping ReLU activation nodes to our custom plugin for replacement. Actually, TensorRT will fuse 4 nodes together and it will be performed as one node operation, hence achieving little speedup. We tested this in deep learning architecture <a href="https://www.analyticsvidhya.com/blog/2021/03/the-architecture-of-lenet-5/">LeNet5</a> in which it achieved 3x performance.</p>

<br>




<ul class="links-nextprev">
    
    
    <li class="links-nextprev-next">Next â†’<br> 
        <a href="/posts/240202-face-recognition-for-attendance-management/">Face Recognition for Attendance Management</a>
    </li>
    
</ul>


<br>

		</main>

		<footer class="footer">
    <div class="footer-content">
        <p>&copy; Himanshu Mittal 2024. All rights reserved.</p>
        <div class="footer-social-links">
            <a href="mailto:himanshu.mittal.dev@gmail.com" title="Email" target="_blank" rel="noopener">
                <i class="fas fa-envelope"></i>
            </a>
            <a href="https://linkedin.com/in/himanshumittal13" title="LinkedIn" target="_blank" rel="noopener">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="https://github.com/HimanshuMittal01" title="GitHub" target="_blank" rel="noopener">
                <i class="fab fa-github"></i>
            </a>
            <a href="https://twitter.com/thesevenbow" title="Twitter" target="_blank" rel="noopener">
                <i class="fab fa-twitter"></i>
            </a>
        </div>
    </div>
</footer>
	</div>

	<script type="text/javascript">

		const toggleButton = document.querySelector(".color-mode-toggle");
console.log(toggleButton);
const toggleIcon = document.querySelector(".toggle-icon");

// Function to toggle color mode
function toggleColorMode() {
    const isDark = document.documentElement.classList.toggle("dark-mode");
    console.log(isDark)

    // Update the toggle icon
    toggleIcon.textContent = isDark ? "ðŸŒ™" : "ðŸŒž";

    // Save the user's preference in localStorage
    localStorage.setItem("color-mode", isDark ? "dark" : "light");
}

// Attach the event listener
toggleButton.addEventListener("click", toggleColorMode);

// Determine initial color mode
const savedMode = localStorage.getItem("color-mode");
if (savedMode) {
    // Apply saved preference
    if (savedMode === "dark") {
        document.documentElement.classList.add("dark-mode");
        toggleIcon.textContent = "ðŸŒ™";
    } else {
        toggleIcon.textContent = "ðŸŒž";
    }
} else {
    // Default to system preference
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        document.documentElement.classList.add("dark-mode");
        toggleIcon.textContent = "ðŸŒ™";
    } else {
        toggleIcon.textContent = "ðŸŒž";
    }
}


	</script>
</body>

</html>